<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Session 1.2 | Intro to R workshop</title>
<meta name="author" content="Emily Nordmann">
<meta name="description" content="For the second session, we're going to do a whistle-stop tour through the following paper: Nordmann, E., McAleer, P., Toivo, W., Paterson, H. &amp; DeBruine, L. (accepted). Data visualisation using R,...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="Chapter 4 Session 1.2 | Intro to R workshop">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/workshop-dataviz/session-1-2.html">
<meta property="og:image" content="https://psyteachr.github.io/workshop-dataviz/images/logos/logo.png">
<meta property="og:description" content="For the second session, we're going to do a whistle-stop tour through the following paper: Nordmann, E., McAleer, P., Toivo, W., Paterson, H. &amp; DeBruine, L. (accepted). Data visualisation using R,...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Session 1.2 | Intro to R workshop">
<meta name="twitter:description" content="For the second session, we're going to do a whistle-stop tour through the following paper: Nordmann, E., McAleer, P., Toivo, W., Paterson, H. &amp; DeBruine, L. (accepted). Data visualisation using R,...">
<meta name="twitter:image" content="https://psyteachr.github.io/workshop-dataviz/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Intro to R workshop</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="installing-r.html"><span class="header-section-number">1</span> Prep: Installing R</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Prep: Intro to R and RStudio</a></li>
<li><a class="" href="session-1-1.html"><span class="header-section-number">3</span> Session 1.1</a></li>
<li><a class="active" href="session-1-2.html"><span class="header-section-number">4</span> Session 1.2</a></li>
<li><a class="" href="session-2-1.html"><span class="header-section-number">5</span> Session 2.1</a></li>
<li><a class="" href="session-2-2.html"><span class="header-section-number">6</span> Session 2.2</a></li>
<li><a class="" href="session-3-1.html"><span class="header-section-number">7</span> Session 3.1</a></li>
<li><a class="" href="session-3-2.html"><span class="header-section-number">8</span> Session 3.2</a></li>
<li><a class="" href="session-4-1.html"><span class="header-section-number">9</span> Session 4.1</a></li>
<li><a class="" href="session-4-2.html"><span class="header-section-number">10</span> Session 4.2</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="glossary.html"><span class="header-section-number">A</span> Glossary</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/psyteachr/template">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="session-1-2" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Session 1.2<a class="anchor" aria-label="anchor" href="#session-1-2"><i class="fas fa-link"></i></a>
</h1>
<p>For the second session, we're going to do a whistle-stop tour through the following paper:</p>
<blockquote>
<p><a href="https://psyteachr.github.io/introdataviz/">Nordmann, E., McAleer, P., Toivo, W., Paterson, H. &amp; DeBruine, L. (accepted). Data visualisation using R, for researchers who don't use R. Advances in Methods and Practices in Psychological Science.</a></p>
</blockquote>
<p>The first half of the session will consolidate the skills and functions you learned in Session 1 with a bit of extra data wrangling, however, we'll use simulated experimental data so that you can start thinking about how you might plot types of data you're likely to encounter in research. The second half will present some more advanced plots. Please note that there is extra detail and context in the paper that may not be covered in this workshop so we'd encourage reading the full paper if you haven't already.</p>
<div id="set-up" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Set-up<a class="anchor" aria-label="anchor" href="#set-up"><i class="fas fa-link"></i></a>
</h2>
<p>Open your Workshop project and do the following:</p>
<ul>
<li>Create and save a new R Markdown document named Session 1.2. get rid of the default template text from line 11 onwards.</li>
<li>In your project folder, create a new sub-folder named <code>data</code>.</li>
<li>Download the simulated dataset from <a href="https://osf.io/m28bz/">the Open Science Framework</a> and save it in your newly created data folder.</li>
<li>Add the below code to the set-up chunk and then run the code to load the packages and data.</li>
</ul>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/ldt_data.csv"</span><span class="op">)</span></code></pre></div>
</div>
<div id="simulated-dataset" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Simulated dataset<a class="anchor" aria-label="anchor" href="#simulated-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>For the purpose of this tutorial, we will use simulated data for a 2 x 2 mixed-design lexical decision task in which 100 participants must decide whether a presented word is a real word or a non-word. There are 100 rows (1 for each participant) and 7 variables:</p>
<ul>
<li>
<p>Participant information:</p>
<ul>
<li>
<code>id</code>: Participant ID</li>
<li>
<code>age</code>: Age</li>
</ul>
</li>
<li>
<p>1 between-subject independent variable (IV):</p>
<ul>
<li>
<code>language</code>: Language group (1 = monolingual, 2 = bilingual)</li>
</ul>
</li>
<li>
<p>4 columns for the 2 dependent variables (DVs) of RT and accuracy, crossed by the within-subject IV of condition:</p>
<ul>
<li>
<code>rt_word</code>: Reaction time (ms) for word trials</li>
<li>
<code>rt_nonword</code>: Reaction time (ms) for non-word trials</li>
<li>
<code>acc_word</code>: Accuracy for word trials</li>
<li>
<code>acc_nonword</code>: Accuracy for non-word trials</li>
</ul>
</li>
</ul>
</div>
<div id="checking-and-cleaning-your-data" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Checking and cleaning your data<a class="anchor" aria-label="anchor" href="#checking-and-cleaning-your-data"><i class="fas fa-link"></i></a>
</h2>
<p>You should always check after importing data that the resulting table looks like you expect. To view the dataset, click <code>dat</code> in the environment pane or run <code>View(dat)</code> in the console. The environment pane also tells us that the object <code>dat</code> has 100 observations of 7 variables, and this is a useful quick check to ensure one has loaded the right data. Note that the 7 variables have an additional piece of information <code>chr</code> and <code>num</code>; this specifies the kind of data in the column. Similar to Excel and SPSS, R uses this information (or variable type) to specify allowable manipulations of data. For instance character data such as the <code>id</code> cannot be averaged, while it is possible to do this with numerical data such as the <code>age</code>.</p>
<div id="handling-numeric-factors" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> Handling numeric factors<a class="anchor" aria-label="anchor" href="#handling-numeric-factors"><i class="fas fa-link"></i></a>
</h3>
<p>Another useful check is to use the functions <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> and <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code> (structure) to check what kind of data R thinks is in each column. Run the below code and look at the output of each, comparing it with what you know about the simulated dataset:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></code></pre></div>
<p>Because the factor <code>language</code> is coded as 1 and 2, R has categorised this column as containing numeric information and unless we correct it, this will cause problems for visualisation and analysis. The code below shows how to recode numeric codes into labels.</p>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> makes new columns in a data table, or overwrites a column;</li>
<li>
<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> translates the language column into a factor with the labels "monolingual" and "bilingual". You can also use <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> to set the display order of a column that contains words. Otherwise, they will display in alphabetical order. In this case we are replacing the numeric data (1 and 2) in the <code>language</code> column with the equivalent English labels <code>monolingual</code> for 1 and <code>bilingual</code> for 2. At the same time we will change the column type to be a factor, which is how R defines categorical data.</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">dat</span>, language <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="va">language</span>, <span class="co"># column to translate</span>
  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="co"># values of the original data in preferred order</span>
  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"monolingual"</span>, <span class="st">"bilingual"</span><span class="op">)</span> <span class="co"># labels for display</span>
<span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Make sure that you always check the output of any code that you run. If after running this code <code>language</code> is full of <code>NA</code> values, it means that you have run the code twice. The first time would have worked and transformed the values from <code>1</code> to <code>monolingual</code> and <code>2</code> to <code>bilingual</code>. If you run the code again on the same dataset, it will look for the values <code>1</code> and <code>2</code>, and because there are no longer any that match, it will return NA. If this happens, you will need to reload the dataset from the csv file.</p>
<p>A good way to avoid this is never to overwrite data, but to always store the output of code in new objects (e.g., <code>dat_recoded</code>) or new variables (<code>language_recoded</code>). For the purposes of this tutorial, overwriting provides a useful teachable moment so we'll leave it as it is.</p>
</div>
</div>
<div id="basic-plot-recap" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Basic plot recap<a class="anchor" aria-label="anchor" href="#basic-plot-recap"><i class="fas fa-link"></i></a>
</h2>
<p>The code for the next couple of plots should be quite familiar from session 1. Before you run the code, try to visualise what it will look like from reading the code.</p>
<p>A bar chart of counts for the number of participants:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Language group"</span>, 
                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Monolingual"</span>, <span class="st">"Bilingual"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Number of participants"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">50</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure3"></span>
<img src="04-session1.2_files/figure-html/figure3-1.png" alt="Bar chart of counts." width="100%"><p class="caption">
Figure 4.1: Bar chart of counts.
</p>
</div>
<p>A histogram of participant age:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"wheat"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Participant age (years)"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure9"></span>
<img src="04-session1.2_files/figure-html/figure9-1.png" alt="Histogram with a custom theme." width="100%"><p class="caption">
Figure 4.2: Histogram with a custom theme.
</p>
</div>
</div>
<div id="data-formats" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Data formats<a class="anchor" aria-label="anchor" href="#data-formats"><i class="fas fa-link"></i></a>
</h2>
<p>To visualise the experimental reaction time and accuracy data using <code>ggplot2</code>, we first need to reshape the data from wide format to long format. This step can cause friction with novice users of R. Traditionally, psychologists have been taught data skills using wide-format data. Wide-format data typically has one row of data for each participant, with separate columns for each score or variable. For repeated-measures variables, the dependent variable is split across different columns. For between-groups variables, a separate column is added to encode the group to which a participant or observation belongs.</p>
<p>The simulated lexical decision data is currently in wide format (see Table <a href="session-1-2.html#tab:wide-data">4.1</a>), where each participant's aggregated reaction time and accuracy for each level of the within-subject variable is split across multiple columns for the repeated factor of condition (words versus non-words).</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:wide-data">Table 4.1: </span>Data in wide format.
</caption>
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
language
</th>
<th style="text-align:right;">
rt_word
</th>
<th style="text-align:right;">
rt_nonword
</th>
<th style="text-align:right;">
acc_word
</th>
<th style="text-align:right;">
acc_nonword
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
379.46
</td>
<td style="text-align:right;">
516.82
</td>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
312.45
</td>
<td style="text-align:right;">
435.04
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
82
</td>
</tr>
<tr>
<td style="text-align:left;">
S003
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
404.94
</td>
<td style="text-align:right;">
458.50
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
87
</td>
</tr>
<tr>
<td style="text-align:left;">
S004
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
298.37
</td>
<td style="text-align:right;">
335.89
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
76
</td>
</tr>
<tr>
<td style="text-align:left;">
S005
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
316.42
</td>
<td style="text-align:right;">
401.32
</td>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:left;">
S006
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:right;">
357.17
</td>
<td style="text-align:right;">
367.34
</td>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
78
</td>
</tr>
</tbody>
</table></div>
<p>Moving from using wide-format to long-format datasets can require a conceptual shift on the part of the researcher and one that usually only comes with practice and repeated exposure. It may be helpful to make a note that “row = participant” (wide format) and “row = observation” (long format) until you get used to moving between the formats. For our example dataset, adhering to these rules for reshaping the data would produce Table <a href="session-1-2.html#tab:long">4.2</a>. Rather than different observations of the same dependent variable being split across columns, there is now a single column for the DV reaction time, and a single column for the DV accuracy. Each participant now has multiple rows of data, one for each observation (i.e., for each participant there will be as many rows as there are levels of the within-subject IV). Although there is some repetition of age and language group, each row is unique when looking at the combination of measures.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:long">Table 4.2: </span>Data in the correct format for visualization.
</caption>
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
language
</th>
<th style="text-align:left;">
condition
</th>
<th style="text-align:right;">
rt
</th>
<th style="text-align:right;">
acc
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
379.46
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
516.82
</td>
<td style="text-align:right;">
90
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
312.45
</td>
<td style="text-align:right;">
94
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
435.04
</td>
<td style="text-align:right;">
82
</td>
</tr>
<tr>
<td style="text-align:left;">
S003
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
404.94
</td>
<td style="text-align:right;">
96
</td>
</tr>
<tr>
<td style="text-align:left;">
S003
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
458.50
</td>
<td style="text-align:right;">
87
</td>
</tr>
</tbody>
</table></div>
<p>The benefits and flexibility of this format will hopefully become apparent as we progress through the workshop, however, a useful rule of thumb when working with data in R for visualisation is that <em>anything that shares an axis should probably be in the same column</em>. For example, a simple boxplot showing reaction time by condition would display the variable <code>condition</code> on the x-axis with bars representing both the <code>word</code> and <code>nonword</code> data, and <code>rt</code> on the y-axis. Therefore, all the data relating to <code>condition</code> should be in one column, and all the data relating to <code>rt</code> should be in a separate single column, rather than being split like in wide-format data.</p>
<div id="wide-to-long-format" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> Wide to long format<a class="anchor" aria-label="anchor" href="#wide-to-long-format"><i class="fas fa-link"></i></a>
</h3>
<p>We have chosen a 2 x 2 design with two DVs, as we anticipate that this is a design many researchers will be familiar with and may also have existing datasets with a similar structure. However, it is worth normalising that trial-and-error is part of the process of learning how to apply these functions to new datasets and structures. Data visualisation can be a useful way to scaffold learning these data transformations because they can provide a concrete visual check as to whether you have done what you intended to do with your data.</p>
<div id="step-1-pivot_longer" class="section level4" number="4.5.1.1">
<h4>
<span class="header-section-number">4.5.1.1</span> Step 1: <code>pivot_longer()</code><a class="anchor" aria-label="anchor" href="#step-1-pivot_longer"><i class="fas fa-link"></i></a>
</h4>
<p>The first step is to use the function <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code> to transform the data to long-form. We have purposefully used a more complex dataset with two DVs for this tutorial to aid researchers applying our code to their own datasets. Because of this, we will break down the steps involved to help show how the code works.</p>
<p>This first code ignores that the dataset has two DVs, a problem we will fix in step 2. The pivot functions can be easier to show than tell - you may find it a useful exercise to run the below code and compare the newly created object <code>long</code> (Table <a href="session-1-2.html#tab:long1-example">4.3</a>) with the original <code>dat</code> Table <a href="session-1-2.html#tab:wide-data">4.1</a> before reading on.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, 
                     cols <span class="op">=</span> <span class="va">rt_word</span><span class="op">:</span><span class="va">acc_nonword</span>, 
                     names_to <span class="op">=</span> <span class="st">"dv_condition"</span>,
                     values_to <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span></code></pre></div>
<ul>
<li><p>As with the other tidyverse functions, the first argument specifies the dataset to use as the base, in this case <code>dat</code>. This argument name is often dropped in examples.</p></li>
<li><p><code>cols</code> specifies all the columns you want to transform. The easiest way to visualise this is to think about which columns would be the same in the new long-form dataset and which will change. If you refer back to Table <a href="session-1-2.html#tab:wide-data">4.1</a>, you can see that <code>id</code>, <code>age</code>, and <code>language</code> all remain, while the columns that contain the measurements of the DVs change. The colon notation <code>first_column:last_column</code> is used to select all variables from the first column specified to the last In our code, <code>cols</code> specifies that the columns we want to transform are <code>rt_word</code> to <code>acc_nonword</code>.</p></li>
<li><p><code>names_to</code> specifies the name of the new column that will be created. This column will contain the names of the selected existing columns.</p></li>
<li><p>Finally, <code>values_to</code> names the new column that will contain the values in the selected columns. In this case we'll call it <code>dv</code>.</p></li>
</ul>
<p>At this point you may find it helpful to go back and compare <code>dat</code> and <code>long</code> again to see how each argument matches up with the output of the table.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:long1-example">Table 4.3: </span>Data in long format with mixed DVs.
</caption>
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
language
</th>
<th style="text-align:left;">
dv_condition
</th>
<th style="text-align:right;">
dv
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt_word
</td>
<td style="text-align:right;">
379.46
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt_nonword
</td>
<td style="text-align:right;">
516.82
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
acc_word
</td>
<td style="text-align:right;">
99.00
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
acc_nonword
</td>
<td style="text-align:right;">
90.00
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt_word
</td>
<td style="text-align:right;">
312.45
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt_nonword
</td>
<td style="text-align:right;">
435.04
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="step-2-pivot_longer-adjusted" class="section level4" number="4.5.1.2">
<h4>
<span class="header-section-number">4.5.1.2</span> Step 2: <code>pivot_longer()</code> adjusted<a class="anchor" aria-label="anchor" href="#step-2-pivot_longer-adjusted"><i class="fas fa-link"></i></a>
</h4>
<p>The problem with the above long-format data-set is that <code>dv_condition</code> combines two variables - it has information about the type of DV and the condition of the IV. To account for this, we include a new argument <code>names_sep</code> and adjust <code>name_to</code> to specify the creation of two new columns. Note that we are pivoting the same wide-format dataset <code>dat</code> as we did in step 1.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">long2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, 
                     cols <span class="op">=</span> <span class="va">rt_word</span><span class="op">:</span><span class="va">acc_nonword</span>, 
                     names_sep <span class="op">=</span> <span class="st">"_"</span>, 
                     names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dv_type"</span>, <span class="st">"condition"</span><span class="op">)</span>,
                     values_to <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span></code></pre></div>
<ul>
<li><p><code>names_sep</code> specifies how to split up the variable name in cases where it has multiple components. This is when taking care to name your variables consistently and meaningfully pays off. Because the word to the left of the separator (<code>_</code>) is always the DV type and the word to the right is always the condition of the within-subject IV, it is easy to automatically split the columns.</p></li>
<li><p>Note that when specifying more than one column name, they must be combined using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> and be enclosed in their own quotation marks.</p></li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:long-example">Table 4.4: </span>Data in long format with dv type and condition in separate columns.
</caption>
<thead><tr>
<th style="text-align:left;">
id
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:left;">
language
</th>
<th style="text-align:left;">
dv_type
</th>
<th style="text-align:left;">
condition
</th>
<th style="text-align:right;">
dv
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
379.46
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
516.82
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
acc
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
99.00
</td>
</tr>
<tr>
<td style="text-align:left;">
S001
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
acc
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
90.00
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt
</td>
<td style="text-align:left;">
word
</td>
<td style="text-align:right;">
312.45
</td>
</tr>
<tr>
<td style="text-align:left;">
S002
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:left;">
monolingual
</td>
<td style="text-align:left;">
rt
</td>
<td style="text-align:left;">
nonword
</td>
<td style="text-align:right;">
435.04
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="step-3-pivot_wider" class="section level4" number="4.5.1.3">
<h4>
<span class="header-section-number">4.5.1.3</span> Step 3: <code>pivot_wider()</code><a class="anchor" aria-label="anchor" href="#step-3-pivot_wider"><i class="fas fa-link"></i></a>
</h4>
<p>Although we have now split the columns so that there are separate variables for the DV type and level of condition, because the two DVs are different types of data, there is an additional bit of wrangling required to get the data in the right format for plotting.</p>
<p>In the current long-format dataset, the column <code>dv</code> contains both reaction time and accuracy measures. Keeping in mind the rule of thumb that <em>anything that shares an axis should probably be in the same column,</em> this creates a problem because we cannot plot two different units of measurement on the same axis. To fix this we need to use the function <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code>. Again, we would encourage you at this point to compare <code>long2</code> and <code>dat_long</code> with the below code to try and map the connections before reading on.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span><span class="va">long2</span>, 
                        names_from <span class="op">=</span> <span class="st">"dv_type"</span>, 
                        values_from <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span></code></pre></div>
<ul>
<li><p>The first argument is again the dataset you wish to work from, in this case <code>long2</code>. We have removed the argument name <code>data</code> in this example.</p></li>
<li><p><code>names_from</code> is the reverse of <code>names_to</code> from <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>. It will take the values from the variable specified and use these as the new column names. In this case, the values of <code>rt</code> and <code>acc</code> that are currently in the <code>dv_type</code> column will become the new column names.</p></li>
<li><p><code>values_from</code> is the reverse of <code>values_to</code> from <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer()</a></code>. It specifies the column that contains the values to fill the new columns with. In this case, the new columns <code>rt</code> and <code>acc</code> will be filled with the values that were in <code>dv</code>.</p></li>
</ul>
<p>Again, it can be helpful to compare each dataset with the code to see how it aligns. This final long-form data should look like Table <a href="session-1-2.html#tab:long">4.2</a>.</p>
<p>If you are working with a dataset with only one DV, note that only step 1 of this process would be necessary. Also, be careful not to calculate demographic descriptive statistics from this long-form dataset. Because the process of transformation has introduced some repetition for these variables, the wide-format dataset where one row equals one participant should be used for demographic information. Finally, the three step process noted above is broken down for teaching purposes, in reality, one would likely do this in a single pipeline of code, for example:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, 
                         cols <span class="op">=</span> <span class="va">rt_word</span><span class="op">:</span><span class="va">acc_nonword</span>, 
                         names_sep <span class="op">=</span> <span class="st">"_"</span>, 
                         names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dv_type"</span>, <span class="st">"condition"</span><span class="op">)</span>,
                         values_to <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"dv_type"</span>, 
              values_from <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span></code></pre></div>
<p>Now that we have the experimental data in the right form, we can begin to create some useful visualizations. First, to demonstrate how code recipes can be reused and adapted, we will create histograms of reaction time and accuracy. The below code uses the same template as before but changes the dataset (<code>dat_long</code>), the bin-widths of the histograms, the <code>x</code> variable to display (<code>rt</code>/<code>acc</code>), and the name of the x-axis.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure10"></span>
<img src="04-session1.2_files/figure-html/figure10-1.png" alt="Histograms showing the distribution of reaction time (top) and accuracy (bottom)" width="100%"><p class="caption">
Figure 4.3: Histograms showing the distribution of reaction time (top) and accuracy (bottom)
</p>
</div>
</div>
</div>
<div id="long-to-wide-format" class="section level3" number="4.5.2">
<h3>
<span class="header-section-number">4.5.2</span> Long to wide format<a class="anchor" aria-label="anchor" href="#long-to-wide-format"><i class="fas fa-link"></i></a>
</h3>
<p>Following the rule that <em>anything that shares an axis should probably be in the same column</em> means that we will frequently need our data in long-form when using <code>ggplot2</code>, However, there are some cases when wide format is necessary. For example, we may wish to visualise the relationship between reaction time in the word and non-word conditions. This requires that the corresponding word and non-word values for each participant be in the same row. The easiest way to achieve this in our case would simply be to use the original wide-format data as the input:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt_word</span>, y <span class="op">=</span> <span class="va">rt_nonword</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>However, there may also be cases when you do not have an original wide-format version and you can use the <code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider()</a></code> function to transform from long to wide.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_wide</span> <span class="op">&lt;-</span> <span class="va">dat_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>id_cols <span class="op">=</span> <span class="st">"id"</span>,
              names_from <span class="op">=</span> <span class="st">"condition"</span>, 
              values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rt</span>,<span class="va">acc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:center;">
id
</th>
<th style="text-align:center;">
rt_word
</th>
<th style="text-align:center;">
rt_nonword
</th>
<th style="text-align:center;">
acc_word
</th>
<th style="text-align:center;">
acc_nonword
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
S001
</td>
<td style="text-align:center;">
379.4585
</td>
<td style="text-align:center;">
516.8176
</td>
<td style="text-align:center;">
99
</td>
<td style="text-align:center;">
90
</td>
</tr>
<tr>
<td style="text-align:center;">
S002
</td>
<td style="text-align:center;">
312.4513
</td>
<td style="text-align:center;">
435.0404
</td>
<td style="text-align:center;">
94
</td>
<td style="text-align:center;">
82
</td>
</tr>
<tr>
<td style="text-align:center;">
S003
</td>
<td style="text-align:center;">
404.9407
</td>
<td style="text-align:center;">
458.5022
</td>
<td style="text-align:center;">
96
</td>
<td style="text-align:center;">
87
</td>
</tr>
<tr>
<td style="text-align:center;">
S004
</td>
<td style="text-align:center;">
298.3734
</td>
<td style="text-align:center;">
335.8933
</td>
<td style="text-align:center;">
92
</td>
<td style="text-align:center;">
76
</td>
</tr>
<tr>
<td style="text-align:center;">
S005
</td>
<td style="text-align:center;">
316.4250
</td>
<td style="text-align:center;">
401.3214
</td>
<td style="text-align:center;">
91
</td>
<td style="text-align:center;">
83
</td>
</tr>
<tr>
<td style="text-align:center;">
S006
</td>
<td style="text-align:center;">
357.1710
</td>
<td style="text-align:center;">
367.3355
</td>
<td style="text-align:center;">
96
</td>
<td style="text-align:center;">
78
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="grouped-plots" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Grouped plots<a class="anchor" aria-label="anchor" href="#grouped-plots"><i class="fas fa-link"></i></a>
</h2>
<p>In the long-form dataset, because each variable has its own column, it's much easier to specify that you want to create grouped plots.</p>
<p>For example, we can create grouped density plots by adding <code>fill = condition</code>:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>And grouped scatterplots by adding <code>colour = condition</code>:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">age</span>, colour <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> </code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="accessible-colour-schemes" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> Accessible colour schemes<a class="anchor" aria-label="anchor" href="#accessible-colour-schemes"><i class="fas fa-link"></i></a>
</h2>
<p>One of the drawbacks of using <code>ggplot2</code> for visualisation is that the default colour scheme is not accessible (or visually appealing). The red and green default palette is difficult for colour-blind people to differentiate, and also does not display well in greyscale. You can specify exact custom colours for your plots, but one easy option is to use a custom colour palette. These take the same arguments as their default <code>scale</code> sister functions for updating axis names and labels, but display plots in contrasting colours that can be read by colour-blind people and that also print well in grey scale. For categorical colours, the "Set2", "Dark2" and "Paired" palettes from the <code>brewer</code> scale functions are colourblind-safe (but are hard to distinhuish in greyscale). For continuous colours, such as when colour is representing the magnitude of a correlation in a tile plot, the <code>viridis</code> scale functions provide a number of different colourblind and greyscale-safe options.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">age</span>, colour <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>,
                     name <span class="op">=</span> <span class="st">"Condition"</span>,
                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Word"</span>, <span class="st">"Non-word"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="visualising-summary-statistics" class="section level2" number="4.8">
<h2>
<span class="header-section-number">4.8</span> Visualising summary statistics<a class="anchor" aria-label="anchor" href="#visualising-summary-statistics"><i class="fas fa-link"></i></a>
</h2>
<p>Commonly, rather than visualising distributions of raw data, researchers will wish to visualise means using a bar chart with error bars. As with SPSS and Excel, <code>ggplot2</code> requires you to calculate the summary statistics and then plot the summary. There are at least two ways to do this, in the first you make a table of summary statistics and then plot that table. The second approach is to calculate the statistics within a layer of the plot. That is the approach we will use below.</p>
<p>First we present code for making a bar chart. The code for bar charts is here because it is a common visualisation that is familiar to most researchers. However, we would urge you to use a visualisation that provides more transparency about the distribution of the raw data, such as violin-boxplots .</p>
<p>To summarise the data into means, we use <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code>. Rather than calling a <code>geom_*</code> function, we call <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> and specify how we want to summarise the data and how we want to present that summary in our figure.</p>
<ul>
<li><p><code>fun</code> specifies the summary function that gives us the y-value we want to plot, in this case, <code>mean</code>.</p></li>
<li><p><code>geom</code> specifies what shape or plot we want to use to display the summary. For the first layer we will specify <code>bar</code>. As with the other geom-type functions we have shown you, this part of the <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> function is tied to the aesthetic mapping in the first line of code. The underlying statistics for a bar chart means that we must specify and IV (x-axis) as well as the DV (y-axis).</p></li>
</ul>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>To add the error bars, another layer is added with a second call to <code>stat_summary</code>. This time, the function represents the type of error bars we wish to draw, you can choose from <code>mean_se</code> for standard error, <code>mean_cl_normal</code> for confidence intervals, or <code>mean_sdl</code> for standard deviation. <code>width</code> controls the width of the error bars - try changing the value to see what happens.</p>
<ul>
<li>Whilst <code>fun</code> returns a single value (y) per condition, <code>fun.data</code> returns the y-values we want to plot plus their minimum and maximum values, in this case, <code>mean_se</code>
</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, 
               geom <span class="op">=</span> <span class="st">"errorbar"</span>, 
               width <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></div>
<div id="grouped-violin-boxplots" class="section level3" number="4.8.1">
<h3>
<span class="header-section-number">4.8.1</span> Grouped violin-boxplots<a class="anchor" aria-label="anchor" href="#grouped-violin-boxplots"><i class="fas fa-link"></i></a>
</h3>
<p>As with previous plots, another variable can be mapped to <code>fill</code> for the violin-boxplot and we can also use <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> to add in the mean and errorbars. However, simply adding <code>fill</code> to the mapping causes the different components of the plot to become misaligned because they have different default positions:</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y<span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, 
               fatten <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>,  geom <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, 
               geom <span class="op">=</span> <span class="st">"errorbar"</span>, 
               width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>To rectify this we need to adjust the argument <code>position</code> for each of the misaligned layers. <code><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge()</a></code> instructs R to move (dodge) the position of the plot component by the specified value; finding what value looks best can sometimes take trial and error. We can also set the <code>alpha</code> values to make it easier to distinguish each layer of the plot.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y<span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.25</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, 
               fatten <span class="op">=</span> <span class="cn">NULL</span>, 
               alpha <span class="op">=</span> <span class="fl">0.75</span>,
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, 
               geom <span class="op">=</span> <span class="st">"point"</span>, 
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, 
               geom <span class="op">=</span> <span class="st">"errorbar"</span>, 
               width <span class="op">=</span> <span class="fl">.1</span>,
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="combined-interaction-plots" class="section level3" number="4.8.2">
<h3>
<span class="header-section-number">4.8.2</span> Combined interaction plots<a class="anchor" aria-label="anchor" href="#combined-interaction-plots"><i class="fas fa-link"></i></a>
</h3>
<p>A more complex interaction plot can be produced that takes advantage of the layers to visualise not only the overall interaction, but the change across conditions for each participant.</p>
<p>This code is more complex than all prior code because it does not use a universal mapping of the plot aesthetics. In our code so far, the aesthetic mapping (<code>aes</code>) of the plot has been specified in the first line of code because all layers used the same mapping. However, is is also possible for each layer to use a different mapping -- we encourage you to build up the plot by running each line of code sequentially to see how it all combines.</p>
<ul>
<li>The first call to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> sets up the default mappings of the plot that will be used unless otherwise specified - the <code>x</code>, <code>y</code> and <code>group</code> variable. Note the addition of <code>shape</code>, which will vary the shape of the geom according to the language variable.</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point()</a></code> overrides the default mapping by setting its own <code>colour</code> to draw the data points from each language group in a different colour. <code>alpha</code> is set to a low value to aid readability.</li>
<li>Similarly, <code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line()</a></code> overrides the default grouping variable so that a line is drawn to connect the individual data points for each <em>participant</em> (<code>group = id</code>) rather than each language group, and also sets the colours.<br>
</li>
<li>Finally, the calls to <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary()</a></code> remain largely as they were, with the exception of setting <code>colour = "black"</code> and <code>size = 2</code> so that the overall means and error bars can be more easily distinguished from the individual data points. Because they do not specify an individual mapping, they use the defaults (e.g., the lines are connected by language group). For the error bars, the lines are again made solid.</li>
</ul>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">rt</span>, 
                     group <span class="op">=</span> <span class="va">language</span>, shape <span class="op">=</span> <span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># adds raw data points in each condition</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">language</span><span class="op">)</span>,alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># add lines to connect each participant's data points across conditions</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">id</span>, colour <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># add data points representing cell means</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span>, size <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># add lines connecting cell means by condition</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"line"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># add errorbars to cell means</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, 
               width <span class="op">=</span> <span class="fl">.2</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># change colours and theme</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure30"></span>
<img src="04-session1.2_files/figure-html/figure30-1.png" alt="Interaction plot with by-participant data." width="100%"><p class="caption">
Figure 4.4: Interaction plot with by-participant data.
</p>
</div>
</div>
</div>
<div id="facets-1" class="section level2" number="4.9">
<h2>
<span class="header-section-number">4.9</span> Facets<a class="anchor" aria-label="anchor" href="#facets-1"><i class="fas fa-link"></i></a>
</h2>
<p>There are situations in which it may be useful to create separate plots for each level of a variable using facets. This can also help with accessibility when used instead of or in addition to group colours. The below code is an adaptation of the code used to produce the grouped scatterplot in which it may be easier to see how the relationship changes when the data are not overlaid.</p>
<ul>
<li>Rather than using <code>colour = condition</code> to produce different colours for each level of <code>condition</code>, this variable is instead passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rt</span>, y <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">condition</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure31"></span>
<img src="04-session1.2_files/figure-html/figure31-1.png" alt="Faceted scatterplot" width="100%"><p class="caption">
Figure 4.5: Faceted scatterplot
</p>
</div>
<p>As another example, we can use <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> as an alternative to the grouped violin-boxplot ( in which the variable <code>language</code> is passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code> rather than <code>fill</code>.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y<span class="op">=</span> <span class="va">rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, fatten <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">language</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:figure32"></span>
<img src="04-session1.2_files/figure-html/figure32-1.png" alt="Facted violin-boxplot" width="100%"><p class="caption">
Figure 4.6: Facted violin-boxplot
</p>
</div>
</div>
<div id="axis-labels" class="section level2" number="4.10">
<h2>
<span class="header-section-number">4.10</span> Axis labels<a class="anchor" aria-label="anchor" href="#axis-labels"><i class="fas fa-link"></i></a>
</h2>
<p>Previously when we edited the main axis labels we used the <code>scale_*</code> functions. These functions are useful to know because they allow you to customise many aspects of the scale, such as the breaks and limits. However, if you only need to change the main axis <code>name</code>, there is a quicker way to do so using <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code>. The below code adds a layer to the plot that changes the axis labels for the histogram saved in <code>p1</code> and adds a title and subtitle. The title and subtitle do not conform to APA standards (more on APA formatting in the additional resources), however, for presentations and social media they can be useful.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="st">"wheat"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Age"</span>, title <span class="op">=</span> <span class="st">"Histogram of participant ages"</span>, subtitle <span class="op">=</span> <span class="st">"Full sample"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>You can also use <code><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs()</a></code> to remove axis labels, for example, try adjusting the above code to <code>x = NULL</code>.</p>
</div>
<div id="redundant-aesthetics" class="section level2" number="4.11">
<h2>
<span class="header-section-number">4.11</span> Redundant aesthetics<a class="anchor" aria-label="anchor" href="#redundant-aesthetics"><i class="fas fa-link"></i></a>
</h2>
<p>So far when we have produced plots with colours, the colours were the only way that different levels of a variable were indicated, but it is sometimes preferable to indicate levels with both colour and other means, such as facets or x-axis categories.</p>
<p>The code below adds <code>fill = condition</code> to violin-boxplots. We adjust <code>alpha</code> and use the brewer colour palette to customise the colours. Specifying a <code>fill</code> variable means that by default, R produces a legend for that variable. However, the use of colour is redundant with the x-axis labels, so you can remove this legend with the <code>guides</code> function.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y<span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, fatten <span class="op">=</span> <span class="cn">NULL</span>, alpha <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, geom <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, geom <span class="op">=</span> <span class="st">"errorbar"</span>, width <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="advanced-plots" class="section level2" number="4.12">
<h2>
<span class="header-section-number">4.12</span> Advanced Plots<a class="anchor" aria-label="anchor" href="#advanced-plots"><i class="fas fa-link"></i></a>
</h2>
<p>For the advanced plots, we will use some custom functions: <code>geom_split_violin()</code> and <code>geom_flat_violin()</code>, which you can access through the <code>introdataviz</code> package. These functions are modified from Allen et al. (2021).</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># how to install the introdataviz package to get split and half violin plots</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"psyteachr/introdataviz"</span><span class="op">)</span>

<span class="co"># if you get the error "there is no package called "devtools" run:</span>
<span class="co"># install.packages("devtools") </span></code></pre></div>
<div id="split-violin-plots" class="section level3" number="4.12.1">
<h3>
<span class="header-section-number">4.12.1</span> Split-violin plots<a class="anchor" aria-label="anchor" href="#split-violin-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Split-violin plots remove the redundancy of mirrored violin plots and make it easier to compare the distributions between multiple conditions.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">introdataviz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/introdataviz/man/geom_split_violin.html">geom_split_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>, alpha <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="st">"mean_se"</span>, geom <span class="op">=</span> <span class="st">"pointrange"</span>, 
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="fl">.175</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Condition"</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Non-word"</span>, <span class="st">"Word"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Reaction time (ms)"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">800</span>, <span class="fl">100</span><span class="op">)</span>, 
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Language group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="raincloud-plots" class="section level2" number="4.13">
<h2>
<span class="header-section-number">4.13</span> Raincloud plots<a class="anchor" aria-label="anchor" href="#raincloud-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Raincloud plots combine a density plot, boxplot, raw data points, and any desired summary statistics for a complete visualisation of the data. They are so called because the density plot plus raw data is reminiscent of a rain cloud. The point and line in the centre of each cloud represents its mean and 95% CI. The rain represents individual data points.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rain_height</span> <span class="op">&lt;-</span> <span class="fl">.1</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">rt</span>, fill <span class="op">=</span> <span class="va">language</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># clouds</span>
  <span class="fu">introdataviz</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/introdataviz/man/geom_flat_violin.html">geom_flat_violin</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span>,
    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rain_height</span><span class="op">+</span><span class="fl">.05</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># rain</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">.5</span>, 
              position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">rain_height</span>, height <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># boxplots</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="va">rain_height</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>, 
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="va">rain_height</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># mean and SE point in the cloud</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_cl_normal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">language</span><span class="op">)</span>, 
               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html">position_nudge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">rain_height</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># adjust layout</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">""</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rain_height</span><span class="op">*</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Reaction time (ms)"</span>,
                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">800</span>, <span class="fl">100</span><span class="op">)</span>, 
                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">condition</span>, 
                     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"word"</span>, <span class="st">"nonword"</span><span class="op">)</span>, 
                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Word"</span>, <span class="st">"Non-Word"</span><span class="op">)</span><span class="op">)</span>, 
             nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># custom colours and theme</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span>, name <span class="op">=</span> <span class="st">"Language group"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Dark2"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
        legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,
        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-session1.2_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="glossary-1-2" class="section level2" number="4.14">
<h2>
<span class="header-section-number">4.14</span> Glossary<a class="anchor" aria-label="anchor" href="#glossary-1-2"><i class="fas fa-link"></i></a>
</h2>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm"><tbody><tr></tr></tbody></table></div>
</div>
</div>
<div id="resources-1-2" class="section level2" number="4.15">
<h2>
<span class="header-section-number">4.15</span> Further Resources<a class="anchor" aria-label="anchor" href="#resources-1-2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<a href="https://psyteachr.github.io/ads-v1/viz.html">Applied Data Skils: Data visualisation</a> (from the PsyTeachR team)</li>
<li>
<a href="https://psyteachr.github.io/ads-v1/custom.html">Applied Data Skils: Customising visualisations</a> (from the PsyTeachR team)</li>
<li><a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf">ggplot2 cheat sheet</a></li>
<li><a href="https://psyteachr.github.io/introdataviz/">Data visualisation using R, for researchers who don't use R</a></li>
<li>
<a href="http://r4ds.had.co.nz/data-visualisation.html">Chapter 3: Data Visualisation</a> of <em>R for Data Science</em>
</li>
<li><a href="https://ggplot2.tidyverse.org/articles/">ggplot2 FAQs</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/">ggplot2 documentation</a></li>
<li>
<a href="https://psyteachr.github.io/hack-your-data/">Hack Your Data Beautiful</a> workshop by University of Glasgow postgraduate students</li>
<li>
<a href="http://r4ds.had.co.nz/graphics-for-communication.html">Chapter 28: Graphics for communication</a> of <em>R for Data Science</em>
</li>
<li>
<a href="https://gganimate.com/">gganimate</a>: A package for making animated plots</li>
<li>
<a href="http://www.r-graph-gallery.com/">The R Graph Gallery</a> (this is really useful)</li>
<li>
<a href="https://socviz.co/lookatdata.html">Look at Data</a> from <a href="http://socviz.co/">Data Vizualization for Social Science</a>
</li>
<li>
<a href="http://www.cookbook-r.com/Graphs">Graphs</a> in <em>Cookbook for R</em>
</li>
<li><a href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html">Top 50 ggplot2 Visualizations</a></li>
<li>
<a href="http://www.cookbook-r.com/Graphs/">R Graphics Cookbook</a> by Winston Chang</li>
<li><a href="https://exts.ggplot2.tidyverse.org/">ggplot extensions</a></li>
<li>
<a href="https://plot.ly/ggplot2/">plotly</a> for creating interactive graphs</li>
<li><a href="https://r-spatial.org/r/2018/10/25/ggplot2-sf.html">Drawing Beautiful Maps Programmatically</a></li>
</ul>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;

    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    $(solveme[i]).after(" <span class='webex-icon'></span>");
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    $(selects[i]).after(" <span class='webex-icon'></span>");
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );

  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });

  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="session-1-1.html"><span class="header-section-number">3</span> Session 1.1</a></div>
<div class="next"><a href="session-2-1.html"><span class="header-section-number">5</span> Session 2.1</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#session-1-2"><span class="header-section-number">4</span> Session 1.2</a></li>
<li><a class="nav-link" href="#set-up"><span class="header-section-number">4.1</span> Set-up</a></li>
<li><a class="nav-link" href="#simulated-dataset"><span class="header-section-number">4.2</span> Simulated dataset</a></li>
<li>
<a class="nav-link" href="#checking-and-cleaning-your-data"><span class="header-section-number">4.3</span> Checking and cleaning your data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#handling-numeric-factors"><span class="header-section-number">4.3.1</span> Handling numeric factors</a></li></ul>
</li>
<li><a class="nav-link" href="#basic-plot-recap"><span class="header-section-number">4.4</span> Basic plot recap</a></li>
<li>
<a class="nav-link" href="#data-formats"><span class="header-section-number">4.5</span> Data formats</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#wide-to-long-format"><span class="header-section-number">4.5.1</span> Wide to long format</a></li>
<li><a class="nav-link" href="#long-to-wide-format"><span class="header-section-number">4.5.2</span> Long to wide format</a></li>
</ul>
</li>
<li><a class="nav-link" href="#grouped-plots"><span class="header-section-number">4.6</span> Grouped plots</a></li>
<li><a class="nav-link" href="#accessible-colour-schemes"><span class="header-section-number">4.7</span> Accessible colour schemes</a></li>
<li>
<a class="nav-link" href="#visualising-summary-statistics"><span class="header-section-number">4.8</span> Visualising summary statistics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#grouped-violin-boxplots"><span class="header-section-number">4.8.1</span> Grouped violin-boxplots</a></li>
<li><a class="nav-link" href="#combined-interaction-plots"><span class="header-section-number">4.8.2</span> Combined interaction plots</a></li>
</ul>
</li>
<li><a class="nav-link" href="#facets-1"><span class="header-section-number">4.9</span> Facets</a></li>
<li><a class="nav-link" href="#axis-labels"><span class="header-section-number">4.10</span> Axis labels</a></li>
<li><a class="nav-link" href="#redundant-aesthetics"><span class="header-section-number">4.11</span> Redundant aesthetics</a></li>
<li>
<a class="nav-link" href="#advanced-plots"><span class="header-section-number">4.12</span> Advanced Plots</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#split-violin-plots"><span class="header-section-number">4.12.1</span> Split-violin plots</a></li></ul>
</li>
<li><a class="nav-link" href="#raincloud-plots"><span class="header-section-number">4.13</span> Raincloud plots</a></li>
<li><a class="nav-link" href="#glossary-1-2"><span class="header-section-number">4.14</span> Glossary</a></li>
<li><a class="nav-link" href="#resources-1-2"><span class="header-section-number">4.15</span> Further Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/psyteachr/template/blob/master/book/04-session1.2.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/psyteachr/template/edit/master/book/04-session1.2.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Intro to R workshop</strong>" was written by Emily Nordmann. It was last built on 2022-07-18.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
